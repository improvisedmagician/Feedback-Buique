<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AvaliaÃ§Ã£o - Secretaria de EducaÃ§Ã£o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .emoji-btn {
            filter: grayscale(100%);
            opacity: 0.7;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .emoji-btn:hover {
            filter: grayscale(0%);
            opacity: 1;
            transform: scale(1.15) translateY(-5px);
        }
        .emoji-active {
            filter: grayscale(0%);
            opacity: 1;
            transform: scale(1.25);
            text-shadow: 0 10px 15px rgba(0,0,0,0.2);
        }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hidden-step { display: none !important; }

        /* Fundo GiratÃ³rio */
        body::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            z-index: -1;
            background: linear-gradient(316deg, rgb(255 255 255) 0%, rgb(255 0 0) 50%, rgb(255 255 255) 100%);
            animation: spin-bg 25s linear infinite;
        }
        @keyframes spin-bg {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 sm:p-8 font-sans text-slate-800 relative overflow-hidden">

    <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden relative border border-slate-100 p-8 sm:p-12">

        <div class="w-full bg-slate-100 h-1.5 absolute top-0 left-0 z-10">
            <div id="progress-bar" class="h-full bg-red-600 transition-all duration-500 ease-out" style="width: 11.11%;"></div>
        </div>

        <div class="w-full border-b border-slate-100 pb-4 mb-6 flex flex-col items-center justify-center">
            <span class="text-xs font-black tracking-widest text-red-600 uppercase">Secretaria de EducaÃ§Ã£o</span>
            <div class="flex items-center gap-1 mt-1 text-slate-500 text-sm font-medium">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
                <span>Feedback Institucional 100% AnÃ´nimo</span>
            </div>
        </div>

        <div id="step-1" class="step-container fade-in" data-metric="geral">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 1 de 8</div>
                <h1 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">De modo geral, como vocÃª avalia toda a FormaÃ§Ã£o?</h1>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
            </div>
        </div>

        <div id="step-2" class="step-container hidden-step fade-in" data-metric="palestra">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 2 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">Sobre a palestra, o conteÃºdo e a dinÃ¢mica do palestrante, como vocÃª avalia?</h2>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
                <button onclick="showStep(1)" class="mt-8 text-slate-400 hover:text-red-600 underline text-sm font-medium transition-colors">Voltar</button>
            </div>
        </div>

        <div id="step-3" class="step-container hidden-step fade-in" data-metric="utilidade">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 3 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">Como vocÃª percebe a utilidade do conteÃºdo aplicado Ã  sua rotina profissional?</h2>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
                <button onclick="showStep(2)" class="mt-8 text-slate-400 hover:text-red-600 underline text-sm font-medium transition-colors">Voltar</button>
            </div>
        </div>

        <div id="step-4" class="step-container hidden-step fade-in" data-metric="ambiente">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 4 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">Como vocÃª avalia o ambiente/espaÃ§o?</h2>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
                <button onclick="showStep(3)" class="mt-8 text-slate-400 hover:text-red-600 underline text-sm font-medium transition-colors">Voltar</button>
            </div>
        </div>

        <div id="step-5" class="step-container hidden-step fade-in" data-metric="lanche">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 5 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">Sobre o lanche servido?</h2>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
                <button onclick="showStep(4)" class="mt-8 text-slate-400 hover:text-red-600 underline text-sm font-medium transition-colors">Voltar</button>
            </div>
        </div>

        <div id="step-6" class="step-container hidden-step fade-in" data-metric="oficinas">
            <div class="flex flex-col items-center justify-center w-full min-h-[250px]">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6">Passo 6 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-10">A respeito das oficinas realizadas em sala?</h2>

                <div class="flex justify-center items-center w-full gap-4 sm:gap-8">
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="4">ğŸ˜ <span class="text-sm font-bold text-slate-400">Ã“tima</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="3">ğŸ™‚ <span class="text-sm font-bold text-slate-400">Boa</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="2">ğŸ˜ <span class="text-sm font-bold text-slate-400">Regular</span></button>
                    <button type="button" class="emoji-btn text-5xl sm:text-6xl flex flex-col items-center gap-2" data-rating="1">ğŸ™ <span class="text-sm font-bold text-slate-400">Ruim</span></button>
                </div>
                <button onclick="showStep(5)" class="mt-8 text-slate-400 hover:text-red-600 underline text-sm font-medium transition-colors">Voltar</button>
            </div>
        </div>

        <div id="step-7" class="step-container hidden-step fade-in">
            <div class="flex flex-col w-full">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6 w-max mx-auto">Passo 7 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-2">O que vocÃª mais gostou?</h2>
                <p class="text-slate-500 text-center mb-8 text-base">Conte-nos o ponto alto (opcional).</p>

                <textarea id="q_liked" class="w-full h-32 px-5 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-red-500 outline-none resize-none text-slate-700 text-lg" placeholder="Sua opiniÃ£o Ã© muito importante..."></textarea>

                <div class="flex gap-4 mt-8 w-full">
                    <button type="button" onclick="showStep(6)" class="px-6 py-4 rounded-xl font-bold text-slate-500 bg-slate-100 hover:bg-slate-200 transition-colors w-1/3 text-lg">Voltar</button>
                    <button type="button" onclick="showStep(8)" class="px-6 py-4 rounded-xl font-bold text-white bg-red-600 hover:bg-red-700 transition-colors w-2/3 shadow-lg shadow-red-200 text-lg">PrÃ³xima</button>
                </div>
            </div>
        </div>

        <div id="step-8" class="step-container hidden-step fade-in">
            <div class="flex flex-col w-full">
                <div class="bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-6 w-max mx-auto">Passo 8 de 8</div>
                <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-2">Deixe suas sugestÃµes</h2>
                <p class="text-slate-500 text-center mb-8 text-base">Sua sugestÃ£o nos ajuda a evoluir (opcional).</p>

                <textarea id="q_improve" class="w-full h-32 px-5 py-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-red-500 outline-none resize-none text-slate-700 text-lg" placeholder="Ex: Mais tempo para dinÃ¢micas..."></textarea>

                <div class="flex gap-4 mt-8 w-full">
                    <button type="button" onclick="showStep(7)" class="px-6 py-4 rounded-xl font-bold text-slate-500 bg-slate-100 hover:bg-slate-200 transition-colors w-1/3 text-lg">Voltar</button>
                    <button type="button" id="btnSubmit" onclick="finalizarAvaliacao()" class="px-6 py-4 rounded-xl font-bold text-white bg-green-600 hover:bg-green-700 transition-colors w-2/3 shadow-lg shadow-green-200 text-lg flex justify-center items-center">
                        <span>Finalizar AvaliaÃ§Ã£o</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="step-9" class="step-container hidden-step fade-in">
            <div class="flex flex-col items-center justify-center text-center py-6 min-h-[250px]">
                <div class="w-24 h-24 bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-6 text-5xl shadow-inner">ğŸ‰</div>
                <h2 class="text-3xl font-extrabold mb-3">Muito Obrigado!</h2>
                <p id="msg-sucesso" class="text-slate-500 text-lg">Sua avaliaÃ§Ã£o foi registrada com sucesso.</p>
            </div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

    
        const firebaseConfig = {
  apiKey: "AIzaSyDvokYBY1WNNNCHWECy5nQmSSVPPEFYEAs",
  authDomain: "frequencia-buique.firebaseapp.com",
  databaseURL: "https://frequencia-buique-default-rtdb.firebaseio.com",
  projectId: "frequencia-buique",
  storageBucket: "frequencia-buique.firebasestorage.app",
  messagingSenderId: "757500707726",
  appId: "1:757500707726:web:28445d21ae43b0d61fdadf",
  
};

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ==========================================
        // LÃ“GICA DO FORMULÃRIO (9 Passos)
        // ==========================================
        const EVENT_ID = 'formacao_educacao_2026';
        const totalPassos = 9;
        let passoAtual = 1;
        
        // Novo pacote de dados com 6 mÃ©tricas precisas
        let notas = {
            geral: 0,
            palestra: 0,
            utilidade: 0,
            ambiente: 0,
            lanche: 0,
            oficinas: 0
        };

        function verificarVotoAnterior() {
            if (localStorage.getItem('voted_' + EVENT_ID)) {
                window.showStep(9);
                document.getElementById('msg-sucesso').innerText = "VocÃª jÃ¡ avaliou esta formaÃ§Ã£o. Obrigado!";
            }
        }

        window.showStep = function(stepNumber) {
            document.querySelectorAll('.step-container').forEach(el => el.classList.add('hidden-step'));
            
            const currentStep = document.getElementById(`step-${stepNumber}`);
            currentStep.classList.remove('hidden-step');
            
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.width = `${(stepNumber / totalPassos) * 100}%`;
            
            passoAtual = stepNumber;
            void currentStep.offsetWidth; 
        }

        const emojis = document.querySelectorAll('.emoji-btn');
        emojis.forEach(button => {
            button.addEventListener('click', function() {
                const parent = this.closest('.step-container');
                const metric = parent.dataset.metric;
                
                parent.querySelectorAll('.emoji-btn').forEach(btn => btn.classList.remove('emoji-active'));
                this.classList.add('emoji-active');
                
                notas[metric] = parseInt(this.dataset.rating);
                
                setTimeout(() => window.showStep(passoAtual + 1), 350);
            });
        });

        window.finalizarAvaliacao = async function() {
            // Verifica se todas as 6 notas foram dadas
            if (!notas.geral || !notas.palestra || !notas.utilidade || !notas.ambiente || !notas.lanche || !notas.oficinas) {
                alert("Por favor, volte e certifique-se de preencher todas as carinhas (emojis) antes de enviar.");
                return;
            }

            const btn = document.getElementById('btnSubmit');
            btn.innerHTML = "Salvando...";
            btn.disabled = true;

            const dadosAvaliacao = {
                evento_id: EVENT_ID,
                nota_geral: notas.geral,
                nota_palestra: notas.palestra,
                nota_utilidade: notas.utilidade,
                nota_ambiente: notas.ambiente,
                nota_lanche: notas.lanche,
                nota_oficinas: notas.oficinas,
                comentario_gostou: document.getElementById('q_liked').value.trim(),
                comentario_melhorar: document.getElementById('q_improve').value.trim(),
                data: new Date().toISOString()
            };

            try {
                await addDoc(collection(db, "avaliacoes"), dadosAvaliacao);
                localStorage.setItem('voted_' + EVENT_ID, 'true');
                
                window.showStep(9);
                document.getElementById('msg-sucesso').innerText = "Sua avaliaÃ§Ã£o foi registrada e ajudarÃ¡ muito a Secretaria!";

            } catch (e) {
                console.error("Erro ao adicionar documento: ", e);
                alert("Erro ao enviar. Verifique sua conexÃ£o e tente novamente.");
                btn.innerHTML = "<span>Finalizar AvaliaÃ§Ã£o</span>";
                btn.disabled = false;
            }
        }

        window.onload = verificarVotoAnterior;
    </script>
</body>
</html>